<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tau Chapter Centennial Homecoming</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f7f7f9;color:#111}
    header,section,footer{max-width:960px;margin:0 auto;padding:16px}
    header{background:#002d72;color:#fff}
    h1{margin:8px 0}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px;margin:16px 0;box-shadow:0 1px 2px rgba(0,0,0,.04)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    label{display:block;font-weight:600;margin:8px 0 4px}
    input,select{width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:8px}
    .btn{display:inline-block;background:#0052cc;color:#fff;padding:10px 16px;border-radius:8px;border:none;cursor:pointer}
    .hidden{display:none}
    code{background:#f1f5f9;padding:2px 6px;border-radius:6px}
    .note{font-size:14px;color:#374151}
  </style>
</head>
<body>
  <header>
    <h1>Phi Beta Sigma — Tau Chapter Centennial</h1>
    <p>Register, confirm payment, and see the schedule.</p>
  </header>

  <section class="card">
    <h2>Register</h2>
    <form id="regForm">
      <div class="row">
        <div>
          <label for="name">Full name</label>
          <input id="name" name="name" required>
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" type="email" name="email" required>
        </div>
        <div>
          <label for="phone">Phone</label>
          <input id="phone" name="phone" required>
        </div>
        <div>
          <label for="yearJoined">Year joined</label>
          <input id="yearJoined" name="yearJoined" type="number" min="1900" max="2100" required>
        </div>
        <div>
          <label for="tshirtSize">T‑shirt size</label>
          <select id="tshirtSize" name="tshirtSize" required>
            <option value="">Select…</option>
            <option>M</option><option>L</option><option>XL</option><option>2XL</option>
            <option>3XL</option><option>4XL</option><option>5XL</option>
          </select>
        </div>
        <div class="hidden">
          <label for="website">Website (leave blank)</label>
          <input id="website" name="website" autocomplete="off">
        </div>
      </div>

      <fieldset style="margin:12px 0;padding:12px;border:1px dashed #cbd5e1;border-radius:8px">
        <legend style="font-weight:700">Select package</legend>
        <label><input type="radio" name="tier" value="100|Centennial Sponsorship" checked> $100 Centennial Sponsorship — Tailgate, t‑shirt, special recognition</label><br>
        <label><input type="radio" name="tier" value="50|T-shirt + Tailgate"> $50 T‑shirt + Tailgate</label><br>
        <label><input type="radio" name="tier" value="25|Tailgate Only"> $25 Tailgate Only</label><br>
        <p class="note">Remaining proceeds support current undergrad brothers.</p>
      </fieldset>

      <div id="formMsg" class="note"></div>
      <button id="submitBtn" class="btn" type="submit">Continue</button>
    </form>
  </section>

  <section id="confirmPanel" class="card hidden">
    <h2>Confirm Payment</h2>
    <p>Send <strong id="payAmount">$100</strong> to your chosen method (Cash App/PayPal per instructions on the page), then click the confirm link below to finalize your registration.</p>
    <p>Your payment code: <code id="paymentCode">PENDING</code></p>
    <p><a id="confirmLink" class="btn" href="#">Open Confirm Link</a></p>
  </section>

  <section class="card">
    <h2>Registered Attendees</h2>
    <p class="note">After confirming, your name will appear here automatically.</p>
    <div id="roster"></div>
    <script>
      // Fetch and render roster (simple client-side list)
      (async function(){
        try {
          const res = await fetch('/.netlify/functions/list_registrants');
          const data = await res.json();
          const r = document.getElementById('roster');
          if (!Array.isArray(data.registrants) || !r) return;
          r.innerHTML = data.registrants.map(x => 
            `<div>${x.name} — ${x.yearJoined} — ${x.tshirtSize} — ${x.packageName} ($${x.packageAmount})</div>`
          ).join('') || '<div class="note">No registrants yet.</div>';
        } catch(e){ console.warn('Roster load failed', e); }
      })();
    </script>
  </section>

  <footer class="card">
    <strong>Admin</strong>
    <p class="note">Export CSV (requires x-admin-key header).</p>
  </footer>

  <script src="assets/js/submit-handler.js"></script>
</body>
</html>
